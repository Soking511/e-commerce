import{a as ae}from"./chunk-2AFAITBO.js";import{e as oe}from"./chunk-OCTLU3GV.js";import{a as E}from"./chunk-T344MZPX.js";import{c as $,d as S,e as H,f as z,g as Q,h as A,i as Z,l as Y,m as J,n as K,o as X,p as ee,s as te,u as ie}from"./chunk-DV2R7P5E.js";import{h as W,m as re,n as ne}from"./chunk-AJKLIETP.js";import{$a as k,Ba as M,Db as U,Ga as d,Gb as G,Ha as v,Kb as C,Lb as h,S as F,Ua as w,X as I,Xa as f,Zb as O,aa as T,bb as j,cb as P,db as t,eb as r,fb as x,ja as m,jb as b,ka as p,kb as u,la as g,lb as s,ma as y,rc as q,sc as D,vb as n,wb as _,xb as B,xc as L,yb as N,zc as R}from"./chunk-TXHN3XOK.js";var V=class a{constructor(i,e){this._ApiService=i;this._AuthService=e}currentUserAddress={};state=[];loading=!1;ngOnInit(){}static \u0275fac=function(e){return new(e||a)(I(E),I(ne))};static \u0275prov=F({token:a,factory:a.\u0275fac,providedIn:"root"})};var me=(a,i)=>i._id,pe=(a,i)=>({"bg-green-200":a,"hover:bg-slate-100":i});function ue(a,i){if(a&1){let e=b();t(0,"li",24)(1,"div",25)(2,"div",26),u("click",function(){let o=m(e).$implicit,c=s(2);return p(c.removeProductFromCart(o._id))}),g(),t(3,"svg",27),x(4,"path",28),r()(),y(),t(5,"div",29),x(6,"img",30),t(7,"div")(8,"h2",31),n(9),r(),t(10,"p",32),n(11),C(12,"currency"),r()(),t(13,"div",33)(14,"div",34)(15,"span",35),u("click",function(){let o=m(e).$implicit,c=s(2);return p(c.updateProductQuantity(o.product,-1))}),n(16," - "),r(),t(17,"label",36),n(18),r(),t(19,"span",37),u("click",function(){let o=m(e).$implicit,c=s(2);return p(c.updateProductQuantity(o.product,1))}),n(20," + "),r()(),t(21,"p",38),n(22),C(23,"currency"),r()()()()()}if(a&2){let e=i.$implicit,l=s(2);d(6),f("src",l.imgDomain+e.product.cover,M)("alt",e.product.cover),d(3),_(e.product.name),d(2),B("",h(12,6,e.price)," per unit"),d(7),_(e.quantity),d(4),_(h(23,8,e.price||0*e.quantity))}}function xe(a,i){if(a&1){let e=b();t(0,"div",39),u("click",function(){let o=m(e).$implicit,c=s(2);return p(c.selectedAddress=o._id==c.selectedAddress._id?"":o)}),t(1,"nav",40)(2,"div",41),n(3),t(4,"div",22)(5,"button",42),u("click",function(){let o=m(e).$implicit,c=s(2);return c.selectedAddress=o._id,p(c.guiPopWindows.confirmBoolean=!0)}),g(),t(6,"svg",43),x(7,"path",44),r()()()()()()}if(a&2){let e=i.$implicit,l=s(2);d(2),f("ngClass",G(3,pe,l.selectedAddress._id===e._id,l.selectedAddress._id!==e._id)),d(),N(" ",e.street," | ",e.state," ")}}function fe(a,i){if(a&1){let e=b();t(0,"div",0)(1,"h1",4),n(2,"Cart Items"),r(),t(3,"div",5)(4,"div",6),w(5,ue,24,10,"li",7),r(),t(6,"div",8)(7,"div",9)(8,"p",10),n(9,"Subtotal"),r(),t(10,"p",10),n(11),C(12,"currency"),r()(),t(13,"div",11)(14,"p",10),n(15,"Shipping"),r(),t(16,"p",10),n(17),C(18,"currency"),r()(),x(19,"hr",12),t(20,"div",11)(21,"p",13),n(22,"Total"),r(),t(23,"div")(24,"p",14),n(25),C(26,"currency"),r()()(),x(27,"br")(28,"input",15)(29,"br"),j(30,xe,8,6,"div",16,me),t(32,"div",17),u("click",function(){m(e);let o=s();return p(o.guiPopWindows.editorBoolean=!0)}),t(33,"nav",18)(34,"div",19)(35,"p",20),n(36,"Add New Address "),r(),t(37,"span",21),n(38,"add_box"),r(),x(39,"div",22),r()()(),t(40,"button",23),u("click",function(){m(e);let o=s();return p(o.addOrder())}),n(41,"Check out"),r()()()()}if(a&2){let e=s();d(5),f("ngForOf",e.currentUserCart),d(6),_(h(12,4,e.totalPriceCart)),d(6),_(h(18,6,100)),d(8),_(h(26,8,e.totalPriceCart+100)),d(5),P(e.currentUserAddress)}}function _e(a,i){if(a&1&&(t(0,"div",1)(1,"h1",45),n(2,"You Don't Have a Cart yet"),r(),t(3,"p",46),n(4,"Let's get you back "),t(5,"a",47),n(6,"home"),r(),n(7,"."),r()()),a&2){let e=s();f("hidden",e.guiPopWindows.confirmedOrder==!0)}}function ve(a,i){if(a&1&&(t(0,"option",67),n(1),r()),a&2){let e=i.$implicit;f("value",e.code),d(),_(e.name)}}function ge(a,i){if(a&1&&(t(0,"option",67),n(1),r()),a&2){let e=i.$implicit;f("value",e.code),d(),_(e.name)}}function be(a,i){if(a&1){let e=b();t(0,"div",2)(1,"div",48)(2,"div",49)(3,"button",50),u("click",function(){m(e);let o=s();return p(o.guiPopWindows.editorBoolean=!1)}),g(),t(4,"svg",51),x(5,"path",52),r()()(),y(),t(6,"h2",53),n(7,"Add New Address"),r(),t(8,"form",54),u("ngSubmit",function(){m(e);let o=s();return p(o.addUserAddress(o.addressForm))}),t(9,"div",55)(10,"label",56),n(11,"Street"),r(),x(12,"input",57),r(),t(13,"div",55)(14,"label",58),n(15,"Governorate"),r(),t(16,"select",59),u("change",function(o){m(e);let c=s();return p(c.onStateChange(o))}),t(17,"option",60),n(18,"Select your state"),r(),w(19,ve,2,2,"option",61),r(),t(20,"label",62),n(21,"City"),r(),t(22,"select",63)(23,"option",60),n(24,"Select your city"),r(),w(25,ge,2,2,"option",61),r()(),t(26,"div",55)(27,"label",64),n(28,"Postal Code"),r(),x(29,"input",65),r(),t(30,"button",66),n(31," Update "),r()()()()}if(a&2){let e=s();d(8),f("formGroup",e.addressForm),d(11),f("ngForOf",e.state),d(6),f("ngForOf",e.selectedState)}}function Ce(a,i){if(a&1){let e=b();t(0,"div",3)(1,"div",68)(2,"div",69)(3,"button",50),u("click",function(){m(e);let o=s();return p(o.guiPopWindows.confirmBoolean=!1)}),g(),t(4,"svg",51),x(5,"path",52),r()()(),y(),t(6,"div",70),g(),t(7,"svg",71),x(8,"path",72),r(),y(),t(9,"h3",73),n(10,"Are you sure you want to delete this address?"),r(),t(11,"a",74),u("click",function(){m(e);let o=s();return o.deleteAddress(o.selectedAddress._id),p(o.guiPopWindows.confirmBoolean=!1)}),n(12,` Yes, I'm sure
`),r(),t(13,"a",75),u("click",function(){m(e);let o=s();return p(o.guiPopWindows.confirmBoolean=!1)}),n(14," No, cancel "),r()()()()}}var le=class a{constructor(i,e,l,o,c,he,ye){this._CartService=i;this._AddressService=e;this._MessageService=l;this._ApiService=o;this._GlobalService=c;this.cdr=he;this._Router=ye}guiPopWindows={confirmBoolean:!1,confirmedOrder:!1,editorBoolean:!1};totalPriceCart=0;currentUserCart=[];currentUserAddress={};selectedState=[];selectedAddress;imgDomain="";state=[];loading=!1;addressForm=new Q({street:new A("",S.required),postalCode:new A("",S.required),city:new A("",S.required),state:new A("",S.required)});onStateChange(i){let l=i.target.value;if(l){let o=this.state.find(c=>c.code===l);this.selectedState=o?o.cityDataModels:[]}}addOrder(){if(!this.selectedAddress)return this.addMessage("error","enter any address","you can add new if u want");this._ApiService.post("orders",{address:this.selectedAddress}).subscribe({next:i=>{this._CartService.emptyCart(),this._Router.navigate(["/order-details"])},error:i=>{}})}removeProductFromCart=i=>this._CartService.removeFromCart(i);updateProductQuantity=(i,e)=>this._CartService.updateQuantity(i._id,e);addMessage=(i="success",e="Service Message",l="MessageService")=>this._MessageService.add({severity:i,summary:e,detail:l});getUserCart(){this._CartService.cart$.subscribe(i=>{this.currentUserCart=i,this.totalPriceCart=0;for(let e of this.currentUserCart)this.totalPriceCart+=e.price*e.quantity;this.cdr.detectChanges(),i.length<1&&(this._Router.navigate(["home"]),this.addMessage("error","you cart is empty","Added to wishlist"))})}fetchCities(){this.state.length===0&&!this.loading&&(this.loading=!0,this._ApiService.fetch("https://atfawry.fawrystaging.com/ECommerceWeb/api/lookups/govs").subscribe({next:i=>{i&&(this.state=i),this.loading=!1},error:i=>{}}))}getUserAddress(){this._ApiService.get("address",void 0,"user").subscribe({next:i=>{Array.isArray(i.data)&&(this.currentUserAddress=i.data,this.selectedAddress=i.data[0])},error:i=>{}})}deleteAddress(i){this._ApiService.delete("address",i).subscribe({next:e=>{this.getUserAddress()},error:e=>{}})}addUserAddress(i){this._ApiService.post("address",{address:[i.value]}).subscribe({next:e=>{location.reload()},error:e=>{}})}ngOnInit(){this.getUserAddress(),this.fetchCities(),this.getUserCart(),this.imgDomain=this._GlobalService.productsImage}static \u0275fac=function(e){return new(e||a)(v(ae),v(V),v(oe),v(E),v(re),v(O),v(W))};static \u0275cmp=T({type:a,selectors:[["app-cart"]],standalone:!0,features:[U],decls:4,vars:3,consts:[[1,"cart-container","bg-gray-100","pt-8"],[1,"bg-center","text-center","py-48",3,"hidden"],["id","editReviewModal",1,"fixed","inset-0","flex","justify-center","items-center"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","justify-center","items-center","z-40"],[1,"mb-10","text-center","text-2xl","font-bold"],[1,"mx-auto","max-w-5xl","justify-center","px-6","md:flex","md:space-x-6","xl:px-0","pb-8"],[1,"rounded-lg","md:w-2/3"],["class","flex flex-col",4,"ngFor","ngForOf"],[1,"rounded-lg","h-full","bg-white","p-4","md:w-1/3"],[1,"mb-2","flex","justify-between"],[1,"text-gray-700"],[1,"flex","justify-between"],[1,"my-4"],[1,"text-lg","font-bold"],[1,"mb-1","text-lg","font-bold"],["id","coupon","placeholder","Enter your coupon code","required","",1,"focus:border-gray-500","rounded-lg","border","border-gray-300","block","w-full","px-3","py-2"],[1,"relative","flex","flex-col","rounded-lg","border","border-slate-200","mb-2"],[1,"relative","flex","flex-col","rounded-lg","border","border-dashed","mb-2",3,"click"],[1,"flex","min-w-[240px]","flex-col","gap-1","p-1.5","max-h-48","overflow-y-auto","flex","justify-center","text-opacity","classes"],["role","button",1,"flex","justify-center","items-center","text-slate-600","text-opacity-75","w-full","rounded-md","p-2","pl-3","transition-all"],[1,"text-lg","font-semibold"],[1,"pl-2","mt-auto","material-symbols-outlined"],[1,"ml-auto","grid","place-items-center","justify-self-end"],[1,"mt-6","w-full","rounded-md","bg-blue-500","py-1.5","font-medium","text-blue-50","hover:bg-blue-600",3,"click"],[1,"flex","flex-col"],[1,"relative","mb-6","rounded-lg","bg-white","p-4","shadow-md","transition-transform","duration-200","ease-in-out","transform","hover:scale-105"],[1,"absolute","top-2","right-2","bg-red-500","rounded-full","p-1","cursor-pointer",3,"click"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke-width","2","stroke","white",1,"h-4","w-4"],["stroke-linecap","round","stroke-linejoin","round","d","M6 18L18 6M6 6l12 12"],[1,"mt-4","sm:mt-2","flex","flex-col","sm:flex-row","sm:justify-between"],["loading","lazy",1,"product-image","w-24","h-24","object-cover","rounded-lg",3,"src","alt"],[1,"text-lg","font-bold","text-gray-800"],[1,"mt-1","text-sm","text-gray-600"],[1,"mt-2","flex","items-center","space-x-3"],[1,"flex","items-center","border","border-gray-300","rounded-md"],[1,"cursor-pointer","bg-gray-100","py-1","px-3","transition-colors","duration-200","hover:bg-blue-500","hover:text-white","rounded-l",3,"click"],[1,"px-4"],[1,"cursor-pointer","bg-gray-100","py-1","px-3","transition-colors","duration-200","hover:bg-blue-500","hover:text-white","rounded-r",3,"click"],[1,"text-sm","font-semibold","text-gray-700"],[1,"relative","flex","flex-col","rounded-lg","border","border-slate-200","mb-2",3,"click"],[1,"flex","min-w-[240px]","flex-col","gap-1","p-1.5","max-h-48","overflow-y-auto"],["role","button",1,"text-slate-800","flex","w-full","items-center","rounded-md","p-2","pl-3","transition-all",3,"ngClass"],["type","button",1,"rounded-md","border","border-transparent","p-2.5","text-center","text-sm","transition-all","text-slate-600","hover:bg-red-400","focus:bg-slate-200","active:bg-slate-200","disabled:pointer-events-none","disabled:opacity-50","disabled:shadow-none",3,"click"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","fill","currentColor",1,"w-4","h-4"],["fill-rule","evenodd","d","M16.5 4.478v.227a48.816 48.816 0 0 1 3.878.512.75.75 0 1 1-.256 1.478l-.209-.035-1.005 13.07a3 3 0 0 1-2.991 2.77H8.084a3 3 0 0 1-2.991-2.77L4.087 6.66l-.209.035a.75.75 0 0 1-.256-1.478A48.567 48.567 0 0 1 7.5 4.705v-.227c0-1.564 1.213-2.9 2.816-2.951a52.662 52.662 0 0 1 3.369 0c1.603.051 2.815 1.387 2.815 2.951Zm-6.136-1.452a51.196 51.196 0 0 1 3.273 0C14.39 3.05 15 3.684 15 4.478v.113a49.488 49.488 0 0 0-6 0v-.113c0-.794.609-1.428 1.364-1.452Zm-.355 5.945a.75.75 0 1 0-1.5.058l.347 9a.75.75 0 1 0 1.499-.058l-.346-9Zm5.48.058a.75.75 0 1 0-1.498-.058l-.347 9a.75.75 0 0 0 1.5.058l.345-9Z","clip-rule","evenodd"],[1,"mb-4","text-4xl","font-semibold","text-red-600"],[1,"mt-4","text-gray-600"],["href","/",1,"text-blue-500"],[1,"bg-white","rounded-lg","shadow-lg","p-6","w-11/12","max-w-lg","relative"],[1,"flex","justify-end"],["type","button",1,"text-gray-400","bg-transparent","hover:bg-gray-200","hover:text-gray-300","rounded-lg","text-sm","p-1.5","ml-auto","inline-flex","items-center",3,"click"],["fill","currentColor","viewBox","0 0 20 20","xmlns","http://www.w3.org/2000/svg",1,"w-5","h-5"],["fill-rule","evenodd","d","M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule","evenodd"],[1,"text-lg","font-semibold","mb-4"],[1,"mb-6",3,"ngSubmit","formGroup"],[1,"mb-4"],["for","street",1,"block","text-sm","font-medium","text-gray-700"],["id","street","formControlName","street","placeholder","Enter your street","required","",1,"focus:border-gray-500","border","border-gray-300","rounded","block","w-full","px-3","py-2"],["for","state",1,"block","text-sm","font-medium","text-gray-700"],["id","state","formControlName","state","required","",1,"focus:border-gray-500","border","border-gray-300","rounded","block","w-full","px-3","py-2",3,"change"],["value","","disabled","","selected",""],[3,"value",4,"ngFor","ngForOf"],["for","city",1,"block","text-sm","font-medium","text-gray-700","mt-4"],["id","city","formControlName","city","required","",1,"focus:border-gray-500","border","border-gray-300","rounded","block","w-full","px-3","py-2"],["for","postalCode",1,"block","text-sm","font-medium","text-gray-700"],["id","postalCode","formControlName","postalCode","placeholder","Enter your postal code","required","",1,"focus:border-gray-500","border","border-gray-300","rounded","block","w-full","px-3","py-2"],["type","submit",1,"bg-transparent","hover:bg-green-500","text-green-700","font-semibold","hover:text-white","py-2","px-4","border","border-green-500","hover:border-transparent","rounded"],[3,"value"],[1,"border","rounded-lg","shadow","bg-white","relative","max-w-sm"],[1,"flex","justify-end","p-2"],[1,"p-6","pt-0","text-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24","xmlns","http://www.w3.org/2000/svg",1,"w-20","h-20","text-red-600","mx-auto"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"text-xl","font-normal","text-gray-500","mt-5","mb-6"],[1,"cursor-pointer","text-white","bg-red-600","hover:bg-red-800","focus:ring-4","focus:ring-red-300","font-medium","rounded-lg","text-base","inline-flex","items-center","px-3","py-2.5","text-center","mr-2",3,"click"],[1,"cursor-pointer","bg-transparent","hover:bg-green-500","text-green-700","font-semibold","hover:text-white","py-2","px-4","border","border-green-500","hover:border-transparent","rounded","font-medium","inline-flex","items-center","rounded-lg","text-base","px-3","py-2.5","text-center",3,"click"]],template:function(e,l){e&1&&w(0,fe,42,10,"div",0)(1,_e,8,1,"div",1)(2,be,32,3,"div",2)(3,Ce,15,0,"div",3),e&2&&(k(l.currentUserCart?0:1),d(2),k(l.guiPopWindows.editorBoolean?2:-1),d(),k(l.guiPopWindows.confirmBoolean?3:-1))},dependencies:[ie,Z,X,ee,$,K,H,z,te,Y,J,R,q,D,L]})};export{le as CartComponent};
